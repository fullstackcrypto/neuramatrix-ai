<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbyW-HLGZ3gmaQQAPmVWLdfYJq1GIB27W39pE3Zo4UQ1AHabTUwR5hwJHJFB2g4pw2M1/exec";

  document.getElementById("contact-form").addEventListener("submit", function (e) {
    e.preventDefault();
    const form = e.target;
    const name = form.name.value.trim();
    const email = form.email.value.trim();
    const message = form.message.value.trim();

    if (!name || !email || !message) {
      document.getElementById("form-status").innerText = "Please complete all fields before submitting.";
      return;
    }

    const data = { name, email, message };
    document.getElementById("form-status").innerText = "Sending...";

    fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(data),
      headers: {
        "Content-Type": "application/json",
      },
    })
    .then(res => {
      if (res.ok) {
        document.getElementById("form-status").innerText = "Message sent successfully!";
        form.reset();
      } else {
        throw new Error("Failed to send.");
      }
    })
    .catch(err => {
      document.getElementById("form-status").innerText = "Error sending message. Please try again.";
      console.error("Submission error", err);
    });
  });
</script>